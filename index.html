<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ° C9 1íšŒì°¨ ë‚­í”Œë‹¨</title>

<style>
/* ===== ì „ì²´ ë ˆì´ì•„ì›ƒ ===== */
body {
    background: #FFF6FA;
    font-family: "Pretendard", -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
    display: flex;
    justify-content: center;
    padding: 20px 16px;
    margin: 0;
    color: #4c2d3b;
}
.wrap {
    width: 100%;
    max-width: 1080px;
    margin: 0 auto;
}

h1 {
    text-align: center;
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 12px;
    color: #FF8FB2;
}

/* ===== ê²€ìƒ‰ë°” ===== */
.filter-bar {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 12px;
    font-size: 13px;
}
.filter-bar input {
    flex: 1;
    max-width: 260px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid #ffd6ea;
    background: #FFF9FD;
    outline: none;
}
.filter-bar input:focus {
    border-color: #ff9fc7;
    box-shadow: 0 0 0 2px rgba(255,159,199,0.25);
}

/* ===== í…Œì´ë¸” ===== */
.table-scroll {
    overflow-x: auto;
    padding-bottom: 4px;
}
.table {
    display: flex;
    flex-direction: column;
    gap: 4px;
    min-width: 760px;
}

.row {
    display: flex;
    background: white;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 1px 4px rgba(255,150,180,0.08);
    padding: 2px 0;
    position: relative;
}

/* ===== ì…€ ===== */
.cell {
    padding: 6px 10px;
    font-size: 14px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    border-right: 1px solid #FFE1EF;
    outline: none;
    cursor: text;
    white-space: nowrap;
    position: relative;
    min-width: 70px;
}
.cell:last-child {
    border-right: none;
}

/* ===== ì—´ ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ ===== */
.resize-handle {
    position: absolute;
    right: 0;
    top: 0;
    width: 6px;
    height: 100%;
    cursor: col-resize;
    background: transparent;
}
.cell:hover .resize-handle {
    background: rgba(255, 150, 180, 0.3);
}

/* ===== í—¤ë” ===== */
.header {
    background: #FFEFF7;
}
.header .cell {
    font-weight: 700;
    color: #D04F7D;
    border-bottom: 2px solid #F8C7DB;
    contenteditable: false;
    cursor: grab;
}

/* ===== í–‰ ì œì–´ ===== */
.action-cell {
    width: 70px;
    position: relative;
}
.action-buttons {
    display: none;
    gap: 4px;
    position: absolute;
    right: 4px;
    top: 50%;
    transform: translateY(-50%);
}
.action-buttons button {
    background: #FFD8EA;
    border: none;
    border-radius: 999px;
    padding: 3px 7px;
    font-size: 11px;
    cursor: pointer;
    color: #D24E78;
}
.row.show-actions .action-buttons {
    display: flex;
}

/* ===== ìƒ‰ìƒ ë ˆë²¨ ===== */
:root {
    --lv1: #FFF9FD;
    --lv2: #FFF3FA;
    --lv3: #FFE9F4;
    --lv4: #FFE0EF;
    --lv5: #FFD7EB;
    --lv6: #FFCEE7;
    --lv7: #FFC6E3;
    --lv8: #FFBEDF;
    --lv9: #FFB6DA;
}

/* ìˆ˜ë™ ìˆ˜ì • í‘œì‹œ */
.ygp-cell.manual {
    background: #F1E8FF;
}

/* ëª¨ë°”ì¼ */
@media (max-width: 600px) {
    .wrap {
        transform: scale(.95);
        transform-origin: top center;
    }
    .resize-handle { display:none; }
}
</style>
</head>

<body>
<div class="wrap">

<h1>ğŸ° C9 1íšŒì°¨ ë‚­í”Œë‹¨</h1>

<div class="filter-bar">
    <input id="search" type="text" placeholder="ì•„ì´ë”” / ë‹‰ë„¤ì„ ê²€ìƒ‰">
</div>

<div class="table-scroll">
<div class="table" id="table">

<!-- ============================ í—¤ë” ============================ -->
<div class="row header">
    <div class="cell">ì•„ì´ë””<div class="resize-handle"></div></div>
    <div class="cell">ë‹‰ë„¤ì„<div class="resize-handle"></div></div>
    <div class="cell amount-cell sort-btn">ë‚­í”Œ<div class="resize-handle"></div></div>
    <div class="cell">ì›í”Œì›<div class="resize-handle"></div></div>
    <div class="cell">ê³µì•½<div class="resize-handle"></div></div>
    <div class="cell">ì—­íŒ¬<div class="resize-handle"></div></div>
    <div class="cell">ë¹„ê³ <div class="resize-handle"></div></div>
    <div class="cell action-cell"></div>
</div>

<!-- ============================ ë°ì´í„° (ë„ˆê°€ ì¤€ ê°’ ê·¸ëŒ€ë¡œ) ============================ -->
<!-- ğŸ”¥ (ê¸¸ì–´ì„œ ìƒëµ ë³´ì—¬ì£¼ê¸°ë¼ë©´ ê³„ì† ìë™ ìƒì„±í•´ì¤„ê²Œ, ì—¬ê¸°ì„  êµ¬ì¡°ë§Œ) -->

<!-- ì˜ˆì‹œ 1í–‰ -->
<div class="row data-row">
    <div class="cell" contenteditable="true">dksl2233<div class="resize-handle"></div></div>
    <div class="cell" contenteditable="true">[C9]ì˜í•´<div class="resize-handle"></div></div>
    <div class="cell amount-cell" contenteditable="true">210092<div class="resize-handle"></div></div>
    <div class="cell" contenteditable="true"></div>
    <div class="cell" contenteditable="true">ì •ì„±ë°©ì…€ + ì—­íŒ¬ 3% or ë°°ë¯¼ 50ë§Œì› + ë°©ì†¡ì†Œì›ê¶Œ + ì‹ë°<div class="resize-handle"></div></div>
    <div class="cell ygp-cell" contenteditable="true" data-auto="true"></div>
    <div class="cell" contenteditable="true"></div>
    <div class="cell action-cell">
        <div class="action-buttons">
            <button class="add">+</button>
            <button class="del">ğŸ—‘</button>
        </div>
    </div>
</div>

<!-- ğŸ”¥ ì „ì²´ ë°ì´í„°ëŠ” ê¸¸ì´ ì œí•œ ë•Œë¬¸ì— ë‹¤ìŒ ë©”ì‹œì§€ì—ì„œ ì´ì–´ì„œ ë¶™ì—¬ì¤„ê²Œ -->

<!-- í•©ê³„ -->
<div class="row summary-row">
    <div class="cell">í•©ê³„</div>
    <div class="cell"></div>
    <div class="cell summary-amount"></div>
    <div class="cell"></div>
    <div class="cell"></div>
    <div class="cell summary-ygp"></div>
    <div class="cell"></div>
    <div class="cell action-cell"></div>
</div>

</div>
</div>
</div>

<script>
/* ============================ ìë™ ê³„ì‚° ============================ */
function applyRowStyle(row){
    const amount = row.querySelector(".amount-cell");
    const ygp = row.querySelector(".ygp-cell");
    if(!amount || !ygp) return;

    let num = parseInt(amount.innerText.replace(/[^0-9]/g,'')) || 0;

    // ìë™ì¼ ê²½ìš° 3%
    if(ygp.dataset.auto !== "false"){
        ygp.innerText = num ? Math.round(num * 0.03) : "";
        ygp.classList.remove("manual");
    }

    // ìƒ‰ ì§€ì •
    let bg="white";
    if(num>=100 && num<=298) bg="var(--lv1)";
    else if(num<=999) bg="var(--lv2)";
    else if(num<=2999) bg="var(--lv3)";
    else if(num<=4999) bg="var(--lv4)";
    else if(num<=9999) bg="var(--lv5)";
    else if(num<=49999) bg="var(--lv6)";
    else if(num<=99999) bg="var(--lv7)";
    else if(num<=299999) bg="var(--lv8)";
    else if(num>=300000) bg="var(--lv9)";

    row.style.background = bg;
}

function updateSummary(){
    let sumA=0, sumY=0;
    document.querySelectorAll(".data-row").forEach(r=>{
        sumA += parseInt(r.querySelector(".amount-cell")?.innerText.replace(/[^0-9]/g,'')) || 0;
        sumY += parseInt(r.querySelector(".ygp-cell")?.innerText.replace(/[^0-9]/g,'')) || 0;
    });
    document.querySelector(".summary-amount").innerText = sumA;
    document.querySelector(".summary-ygp").innerText = sumY;
}

function refreshAll(){
    document.querySelectorAll(".data-row").forEach(applyRowStyle);
    updateSummary();
}

/* ============================ ì—´ ë„ˆë¹„ ì¡°ì • ============================ */
let resizing = false, startX, startWidth, targetCell;

document.addEventListener("mousedown", (e)=>{
    const handle = e.target.closest(".resize-handle");
    if(!handle) return;
    resizing = true;
    targetCell = handle.parentElement;
    startX = e.clientX;
    startWidth = targetCell.offsetWidth;
    document.body.style.userSelect="none";
});

document.addEventListener("mousemove", (e)=>{
    if(!resizing) return;
    const dx = e.clientX - startX;
    targetCell.style.width = Math.max(50, startWidth + dx) + "px";
});

document.addEventListener("mouseup", ()=>{
    resizing = false;
    document.body.style.userSelect="";
});

/* ============================ ì—­íŒ¬ ìˆ˜ë™ ë³€ê²½ ê°ì§€ ============================ */
document.addEventListener("input",(e)=>{
    const cell = e.target;
    const row = cell.closest(".data-row");

    if(!row) return;

    if(cell.classList.contains("ygp-cell")){
        cell.dataset.auto="false";
        cell.classList.add("manual");
    }

    refreshAll();
});

/* ============================ í–‰ í´ë¦­ â†’ í–‰ë™ ë²„íŠ¼ í‘œì‹œ ============================ */
document.addEventListener("click",(e)=>{
    const row = e.target.closest(".data-row");
    document.querySelectorAll(".data-row").forEach(r=>r.classList.remove("show-actions"));
    if(row) row.classList.add("show-actions");
});

/* ============================ ê²€ìƒ‰ ============================ */
document.getElementById("search").addEventListener("input",(e)=>{
    const q = e.target.value.toLowerCase();
    document.querySelectorAll(".data-row").forEach(row=>{
        const id=row.children[0].innerText.toLowerCase();
        const nick=row.children[1].innerText.toLowerCase();
        row.style.display = (id.includes(q)||nick.includes(q)) ? "flex" : "none";
    });
});

/* ============================ ì´ˆê¸°ì‹¤í–‰ ============================ */
window.onload = ()=>{
    refreshAll();
};
</script>

</body>
</html>
